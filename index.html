<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pack de Estudio - Criptograf√≠a en Java</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .header h1 {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .tabs {
            background: white;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .tab-button {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            background: #f3f4f6;
            color: #374151;
        }
        
        .tab-button:hover {
            background: #e5e7eb;
        }
        
        .tab-button.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            min-height: 500px;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* FLASHCARDS */
        .flashcard-container {
            text-align: center;
            max-width: 700px;
            margin: 0 auto;
        }
        
        .flashcard-counter {
            color: #6b7280;
            margin-bottom: 20px;
            font-size: 18px;
        }
        
        .flashcard {
            perspective: 1000px;
            height: 350px;
            margin-bottom: 30px;
            cursor: pointer;
        }
        
        .flashcard-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        
        .flashcard.flipped .flashcard-inner {
            transform: rotateY(180deg);
        }
        
        .flashcard-front, .flashcard-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }
        
        .flashcard-front {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .flashcard-back {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            transform: rotateY(180deg);
        }
        
        .flashcard-text {
            font-size: 1.5em;
            font-weight: 600;
            line-height: 1.5;
            white-space: pre-line;
        }
        
        .flashcard-hint {
            font-size: 0.9em;
            opacity: 0.9;
            margin-top: 15px;
        }
        
        .flashcard-navigation {
            display: flex;
            justify-content: space-between;
            max-width: 700px;
            margin: 0 auto;
        }
        
        .nav-button {
            padding: 12px 30px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            background: #6b7280;
            color: white;
        }
        
        .nav-button:hover {
            background: #4b5563;
            transform: translateY(-2px);
        }
        
        /* TABLES */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }
        
        th {
            background: #f3f4f6;
            font-weight: 600;
        }
        
        .status-obsolete {
            color: #dc2626;
            font-weight: 600;
        }
        
        .status-secure {
            color: #059669;
            font-weight: 600;
        }
        
        .status-warning {
            color: #d97706;
            font-weight: 600;
        }
        
        /* BOXES */
        .info-box {
            background: #dbeafe;
            border-left: 4px solid #3b82f6;
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
        }
        
        .warning-box {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
        }
        
        .success-box {
            background: #d1fae5;
            border-left: 4px solid #10b981;
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
        }
        
        .danger-box {
            background: #fee2e2;
            border-left: 4px solid #ef4444;
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
        }
        
        /* GRID */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .card {
            background: #f9fafb;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
        }
        
        .card h3 {
            color: #1f2937;
            margin-bottom: 15px;
            font-size: 1.2em;
        }
        
        /* CODE */
        .code-block {
            background: #1f2937;
            color: #10b981;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
        }
        
        /* QUESTIONS */
        .question {
            background: #f9fafb;
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            border: 2px solid #e5e7eb;
        }
        
        .question h3 {
            color: #1f2937;
            margin-bottom: 15px;
        }
        
        .options {
            margin-top: 15px;
        }
        
        .option {
            background: white;
            border: 2px solid #e5e7eb;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .option:hover {
            border-color: #667eea;
            background: #f3f4f6;
        }
        
        .option.selected {
            border-color: #667eea;
            background: #eef2ff;
        }
        
        .option.correct {
            border-color: #10b981;
            background: #d1fae5;
        }
        
        .option.incorrect {
            border-color: #ef4444;
            background: #fee2e2;
        }
        
        .explanation {
            margin-top: 15px;
            padding: 15px;
            background: #fef3c7;
            border-radius: 8px;
            border-left: 4px solid #f59e0b;
        }
        
        /* PROCESS STEPS */
        .process-step {
            display: flex;
            align-items: flex-start;
            margin: 15px 0;
        }
        
        .step-number {
            background: #667eea;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            flex-shrink: 0;
        }
        
        .step-content {
            background: #f3f4f6;
            padding: 15px;
            border-radius: 8px;
            flex: 1;
        }
        
        .footer {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
            color: white;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .footer h3 {
            margin-bottom: 15px;
        }
        
        .footer ul {
            list-style: none;
        }
        
        .footer li {
            padding: 5px 0;
        }

        /* TEST RESULT */
        .test-result {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
        }

        .test-result h2 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .test-result.fail {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }

        .submit-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin: 20px auto;
            display: block;
        }

        .submit-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìö Pack Completo de Estudio</h1>
            <p style="color: #6b7280; font-size: 1.1em;">Criptograf√≠a en Java - Preparaci√≥n del Examen</p>
        </div>
        
        <div class="tabs">
            <button class="tab-button active" onclick="showTab('test')">‚úÖ Test General</button>
            <button class="tab-button" onclick="showTab('flashcards')">üìñ Flashcards</button>
            <button class="tab-button" onclick="showTab('schemas')">üó∫Ô∏è Esquemas</button>
            <button class="tab-button" onclick="showTab('cheatsheet')">üìÑ Cheat Sheet</button>
            <button class="tab-button" onclick="showTab('code')">üíª C√≥digo</button>
            <button class="tab-button" onclick="showTab('practical')">üéØ Casos Pr√°cticos</button>
        </div>
        
        <div class="content">
            <!-- TEST GENERAL TAB -->
            <div id="test" class="tab-content active">
                <div class="info-box">
                    <strong>Test General de Criptograf√≠a</strong><br>
                    30 preguntas tipo test sobre todo el temario. Selecciona la respuesta correcta en cada pregunta.
                </div>
                
                <div id="test-questions"></div>
                
                <button class="submit-button" onclick="submitTest()">Ver Resultados</button>
                
                <div id="test-result" style="display: none;"></div>
            </div>

            <!-- FLASHCARDS TAB -->
            <div id="flashcards" class="tab-content">
                <div class="flashcard-container">
                    <div class="flashcard-counter">
                        Tarjeta <span id="current-card">1</span> de <span id="total-cards">24</span>
                    </div>
                    <div class="flashcard" id="flashcard" onclick="flipCard()">
                        <div class="flashcard-inner" id="flashcard-inner">
                            <div class="flashcard-front">
                                <div>
                                    <div class="flashcard-text" id="card-front"></div>
                                    <div class="flashcard-hint">Haz clic para ver la respuesta</div>
                                </div>
                            </div>
                            <div class="flashcard-back">
                                <div>
                                    <div class="flashcard-text" id="card-back"></div>
                                    <div class="flashcard-hint">Haz clic para volver</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="flashcard-navigation">
                        <button class="nav-button" onclick="prevCard()">‚Üê Anterior</button>
                        <button class="nav-button" onclick="nextCard()">Siguiente ‚Üí</button>
                    </div>
                </div>
            </div>
            
            <!-- SCHEMAS TAB -->
            <div id="schemas" class="tab-content">
                <h2 style="color: #1f2937; margin-bottom: 25px;">üîê Tipos de Criptograf√≠a</h2>
                <div class="grid">
                    <div class="card" style="border-left: 4px solid #3b82f6;">
                        <h3>SIM√âTRICA</h3>
                        <p style="margin-bottom: 10px;">üîë 1 clave compartida</p>
                        <ul style="list-style: none; line-height: 1.8;">
                            <li>‚úì MUY r√°pida</li>
                            <li>‚úì Archivos grandes</li>
                            <li>‚úó Distribuci√≥n de clave</li>
                        </ul>
                        <hr style="margin: 15px 0; border: none; border-top: 1px solid #e5e7eb;">
                        <p><strong>Algoritmos:</strong></p>
                        <p>AES (128/192/256)</p>
                        <p style="color: #dc2626;">DES (obsoleto)</p>
                    </div>
                    
                    <div class="card" style="border-left: 4px solid #8b5cf6;">
                        <h3>ASIM√âTRICA</h3>
                        <p style="margin-bottom: 10px;">üîëüîë 2 claves (p√∫blica/privada)</p>
                        <ul style="list-style: none; line-height: 1.8;">
                            <li>‚úì Intercambio seguro</li>
                            <li>‚úì Firma digital</li>
                            <li>‚úó M√°s lenta</li>
                        </ul>
                        <hr style="margin: 15px 0; border: none; border-top: 1px solid #e5e7eb;">
                        <p><strong>Algoritmos:</strong></p>
                        <p>RSA (2048/4096)</p>
                        <p>ECDSA (256)</p>
                    </div>
                </div>
                
                <h2 style="color: #1f2937; margin: 40px 0 25px;">üî® HASH (Funciones Resumen)</h2>
                <div class="warning-box">
                    <h3>Caracter√≠stica clave: UNIDIRECCIONAL</h3>
                    <div class="grid" style="margin-top: 15px;">
                        <div>
                            <p><strong>‚úÖ Seguros:</strong></p>
                            <ul style="list-style: none; line-height: 1.8;">
                                <li>‚Ä¢ SHA-256 / SHA-512</li>
                                <li>‚Ä¢ bcrypt (contrase√±as)</li>
                                <li>‚Ä¢ Argon2 (contrase√±as)</li>
                            </ul>
                        </div>
                        <div>
                            <p><strong>‚ùå Obsoletos:</strong></p>
                            <ul style="list-style: none; line-height: 1.8; color: #dc2626;">
                                <li>‚Ä¢ MD5</li>
                                <li>‚Ä¢ SHA-1</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <h2 style="color: #1f2937; margin: 40px 0 25px;">‚úçÔ∏è Firma Digital - Proceso</h2>
                <div class="process-step">
                    <div class="step-number">1</div>
                    <div class="step-content">Calcular HASH del mensaje</div>
                </div>
                <div class="process-step">
                    <div class="step-number">2</div>
                    <div class="step-content">Cifrar hash con CLAVE PRIVADA = FIRMA</div>
                </div>
                <div class="process-step">
                    <div class="step-number">3</div>
                    <div class="step-content">Enviar mensaje + firma</div>
                </div>
                <div class="process-step">
                    <div class="step-number" style="background: #10b981;">4</div>
                    <div class="step-content" style="background: #d1fae5;">Receptor descifra firma con CLAVE P√öBLICA</div>
                </div>
                <div class="process-step">
                    <div class="step-number" style="background: #10b981;">5</div>
                    <div class="step-content" style="background: #d1fae5;">Comparar hashes ‚Üí Si coinciden: ‚úÖ V√ÅLIDO</div>
                </div>
                <div class="info-box" style="margin-top: 20px;">
                    <p><strong>Garantiza:</strong></p>
                    <p>‚úì Autenticidad | ‚úì Integridad | ‚úì No repudio</p>
                </div>
                
                <h2 style="color: #1f2937; margin: 40px 0 25px;">üé´ Estructura JWT</h2>
                <div class="grid" style="grid-template-columns: repeat(3, 1fr);">
                    <div class="card" style="border-left: 4px solid #ef4444;">
                        <h3 style="color: #dc2626;">HEADER</h3>
                        <p>Tipo de token</p>
                        <p>Algoritmo (HS256)</p>
                    </div>
                    <div class="card" style="border-left: 4px solid #8b5cf6;">
                        <h3 style="color: #7c3aed;">PAYLOAD</h3>
                        <p>Claims (datos)</p>
                        <p>Username, roles</p>
                        <p>Expiraci√≥n</p>
                    </div>
                    <div class="card" style="border-left: 4px solid #10b981;">
                        <h3 style="color: #059669;">SIGNATURE</h3>
                        <p>Verifica integridad</p>
                        <p>HMAC(header+payload)</p>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 20px; font-family: monospace; background: #f3f4f6; padding: 15px; border-radius: 8px;">
                    header.payload.signature
                </div>
                
                <h2 style="color: #1f2937; margin: 40px 0 25px;">üîÑ Cifrado H√≠brido (TLS/HTTPS)</h2>
                <div class="card" style="border-left: 4px solid #8b5cf6; background: #faf5ff;">
                    <p style="font-size: 1.1em; margin-bottom: 10px;"><strong>Paso 1: Intercambio de clave</strong></p>
                    <p>Usa RSA o ECDH (asim√©trica) para intercambiar de forma segura una clave sim√©trica</p>
                </div>
                <div class="card" style="border-left: 4px solid #3b82f6; background: #eff6ff; margin-top: 15px;">
                    <p style="font-size: 1.1em; margin-bottom: 10px;"><strong>Paso 2: Cifrado de datos</strong></p>
                    <p>Usa AES (sim√©trica) para cifrar toda la comunicaci√≥n - MUY R√ÅPIDO</p>
                </div>
                <div class="success-box" style="text-align: center; margin-top: 15px;">
                    <strong style="font-size: 1.2em;">Resultado: Seguridad + Velocidad üöÄ</strong>
                </div>
            </div>
            
            <!-- CHEAT SHEET TAB -->
            <div id="cheatsheet" class="tab-content">
                <h2 style="color: #1f2937; margin-bottom: 25px;">üìä Tabla de Algoritmos</h2>
                <table>
                    <thead>
                        <tr>
                            <th>Algoritmo</th>
                            <th>Tipo</th>
                            <th>Longitud Clave</th>
                            <th>Estado</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>MD5</strong></td>
                            <td>Hash</td>
                            <td>128 bits</td>
                            <td class="status-obsolete">‚ùå OBSOLETO</td>
                        </tr>
                        <tr>
                            <td><strong>SHA-1</strong></td>
                            <td>Hash</td>
                            <td>160 bits</td>
                            <td class="status-obsolete">‚ùå OBSOLETO</td>
                        </tr>
                        <tr>
                            <td><strong>SHA-256</strong></td>
                            <td>Hash</td>
                            <td>256 bits</td>
                            <td class="status-secure">‚úÖ SEGURO</td>
                        </tr>
                        <tr>
                            <td><strong>SHA-512</strong></td>
                            <td>Hash</td>
                            <td>512 bits</td>
                            <td class="status-secure">‚úÖ MUY SEGURO</td>
                        </tr>
                        <tr>
                            <td><strong>bcrypt/Argon2</strong></td>
                            <td>Hash</td>
                            <td>Variable</td>
                            <td class="status-secure">‚úÖ CONTRASE√ëAS</td>
                        </tr>
                        <tr style="background: #f9fafb;">
                            <td><strong>DES</strong></td>
                            <td>Sim√©trica</td>
                            <td>56 bits</td>
                            <td class="status-obsolete">‚ùå OBSOLETO</td>
                        </tr>
                        <tr style="background: #f9fafb;">
                            <td><strong>3DES</strong></td>
                            <td>Sim√©trica</td>
                            <td>168 bits</td>
                            <td class="status-warning">‚ö†Ô∏è TEMPORAL</td>
                        </tr>
                        <tr style="background: #f9fafb;">
                            <td><strong>AES</strong></td>
                            <td>Sim√©trica</td>
                            <td>128/192/256 bits</td>
                            <td class="status-secure">‚úÖ EST√ÅNDAR</td>
                        </tr>
                        <tr style="background: #eff6ff;">
                            <td><strong>RSA</strong></td>
                            <td>Asim√©trica</td>
                            <td>2048-4096 bits</td>
                            <td class="status-secure">‚úÖ SEGURO</td>
                        </tr>
                        <tr style="background: #eff6ff;">
                            <td><strong>ECDSA</strong></td>
                            <td>Asim√©trica</td>
                            <td>256 bits</td>
                            <td class="status-secure">‚úÖ MODERNO</td>
                        </tr>
                    </tbody>
                </table>
                
                <h2 style="color: #1f2937; margin: 40px 0 25px;">‚öñÔ∏è Comparativas R√°pidas</h2>
                <div class="grid">
                    <div class="card">
                        <h3>Hash vs Cifrado</h3>
                        <table style="margin: 0;">
                            <tr>
                                <td><strong>Direcci√≥n:</strong></td>
                                <td>Hash: UNI | Cifrado: BI</td>
                            </tr>
                            <tr>
                                <td><strong>Clave:</strong></td>
                                <td>Hash: NO | Cifrado: S√ç</td>
                            </tr>
                            <tr>
                                <td><strong>Longitud:</strong></td>
                                <td>Hash: FIJA | Cifrado: VARIABLE</td>
                            </tr>
                            <tr>
                                <td><strong>Objetivo:</strong></td>
                                <td>Hash: Integridad | Cifrado: Confidencialidad</td>
                            </tr>
                        </table>
                    </div>
                    
                    <div class="card">
                        <h3>Sim√©trica vs Asim√©trica</h3>
                        <table style="margin: 0;">
                            <tr>
                                <td><strong>Claves:</strong></td>
                                <td>Sim: 1 | Asim: 2</td>
                            </tr>
                            <tr>
                                <td><strong>Velocidad:</strong></td>
                                <td>Sim: R√ÅPIDA | Asim: LENTA</td>
                            </tr>
                            <tr>
                                <td><strong>Tama√±o clave:</strong></td>
                                <td>Sim: 256b | Asim: 2048b</td>
                            </tr>
                            <tr>
                                <td><strong>Uso:</strong></td>
                                <td>Sim: Datos | Asim: Claves</td>
                            </tr>
                        </table>
                    </div>
                </div>
                
                <h2 style="color: #1f2937; margin: 40px 0 25px;">üõ°Ô∏è Spring Security - M√©todos Clave</h2>
                <div class="grid" style="grid-template-columns: repeat(2, 1fr);">
                    <div class="card" style="border-left: 4px solid #10b981;">
                        <p style="font-family: monospace; font-weight: bold; color: #059669;">.permitAll()</p>
                        <p style="font-size: 0.9em; color: #6b7280;">Acceso sin autenticaci√≥n</p>
                    </div>
                    <div class="card" style="border-left: 4px solid #3b82f6;">
                        <p style="font-family: monospace; font-weight: bold; color: #2563eb;">.authenticated()</p>
                        <p style="font-size: 0.9em; color: #6b7280;">Requiere estar logueado</p>
                    </div>
                    <div class="card" style="border-left: 4px solid #8b5cf6;">
                        <p style="font-family: monospace; font-weight: bold; color: #7c3aed;">.hasRole("ADMIN")</p>
                        <p style="font-size: 0.9em; color: #6b7280;">Requiere rol espec√≠fico</p>
                    </div>
                    <div class="card" style="border-left: 4px solid #f59e0b;">
                        <p style="font-family: monospace; font-weight: bold; color: #d97706;">.hasAuthority()</p>
                        <p style="font-size: 0.9em; color: #6b7280;">Requiere autoridad espec√≠fica</p>
                    </div>
                </div>
                
                <h2 style="color: #1f2937; margin: 40px 0 25px;">üîê OAuth2 - Roles</h2>
                <div class="card">
                    <div style="display: grid; grid-template-columns: auto 1fr; gap: 15px; align-items: start;">
                        <div style="background: #667eea; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold;">1</div>
                        <div>
                            <p style="font-weight: bold;">Client</p>
                            <p style="font-size: 0.9em; color: #6b7280;">La aplicaci√≥n que solicita acceso</p>
                        </div>
                        
                        <div style="background: #667eea; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold;">3</div>
                        <div>
                            <p style="font-weight: bold;">Authorization Server</p>
                            <p style="font-size: 0.9em; color: #6b7280;">Emite los tokens (ej: Google)</p>
                        </div>
                        
                        <div style="background: #667eea; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold;">4</div>
                        <div>
                            <p style="font-weight: bold;">Resource Server</p>
                            <p style="font-size: 0.9em; color: #6b7280;">Protege los recursos/datos</p>
                        </div>
                    </div>
                </div>
                
                <h2 style="color: #1f2937; margin: 40px 0 25px;">üîí Modos de Operaci√≥n AES</h2>
                <div class="grid" style="grid-template-columns: repeat(2, 1fr);">
                    <div class="card" style="background: #fee2e2; border-left: 4px solid #ef4444;">
                        <p style="font-family: monospace; font-weight: bold;">ECB</p>
                        <p style="color: #dc2626; font-size: 0.9em;">‚ùå NO RECOMENDADO</p>
                    </div>
                    <div class="card" style="background: #fef3c7; border-left: 4px solid #f59e0b;">
                        <p style="font-family: monospace; font-weight: bold;">CBC</p>
                        <p style="color: #d97706; font-size: 0.9em;">‚ö†Ô∏è Aceptable</p>
                    </div>
                    <div class="card" style="background: #d1fae5; border-left: 4px solid #10b981;">
                        <p style="font-family: monospace; font-weight: bold;">GCM</p>
                        <p style="color: #059669; font-size: 0.9em;">‚úÖ RECOMENDADO</p>
                    </div>
                    <div class="card" style="background: #dbeafe; border-left: 4px solid #3b82f6;">
                        <p style="font-family: monospace; font-weight: bold;">CTR</p>
                        <p style="color: #2563eb; font-size: 0.9em;">‚úÖ Bueno</p>
                    </div>
                </div>
                
                <h2 style="color: #1f2937; margin: 40px 0 25px;">‚öñÔ∏è Equivalencias de Seguridad</h2>
                <div style="background: linear-gradient(135deg, #faf5ff 0%, #eff6ff 100%); padding: 30px; border-radius: 12px; text-align: center;">
                    <p style="font-size: 1.5em; font-weight: bold; color: #1f2937;">256 bits ECDSA ‚âà 3072 bits RSA</p>
                    <p style="color: #6b7280; margin-top: 10px;">Misma seguridad, claves m√°s cortas = m√°s eficiente</p>
                </div>

                <h2 style="color: #1f2937; margin: 40px 0 25px;">‚ö†Ô∏è IMPORTANTE - No confundir</h2>
                <div class="danger-box">
                    <ul style="list-style: none; line-height: 2;">
                        <li><strong>‚Ä¢ Hash NO es cifrado</strong> - Hash es irreversible, cifrado es reversible</li>
                        <li><strong>‚Ä¢ JWT es stateless</strong> - No requiere almacenar sesiones en servidor</li>
                        <li><strong>‚Ä¢ Firma digital</strong> - Se cifra con clave PRIVADA, se verifica con P√öBLICA</li>
                        <li><strong>‚Ä¢ OAuth2 es autorizaci√≥n</strong> - NO es autenticaci√≥n directa</li>
                        <li><strong>‚Ä¢ bcrypt para contrase√±as</strong> - NO usar SHA-256 directamente</li>
                    </ul>
                </div>
            </div>
            
            <!-- CODE TAB -->
            <div id="code" class="tab-content">
                <div class="info-box">
                    <strong>Instrucciones:</strong> Lee cada c√≥digo y identifica el error. Haz clic en la respuesta correcta.
                </div>
                
                <div id="code-questions"></div>
                
                <div style="background: linear-gradient(135deg, #faf5ff 0%, #eff6ff 100%); padding: 25px; border-radius: 12px; margin-top: 30px;">
                    <h3 style="color: #7c3aed; margin-bottom: 15px;">üí° Consejos para c√≥digo:</h3>
                    <ul style="line-height: 1.8;">
                        <li>‚Ä¢ Busca algoritmos obsoletos (MD5, SHA-1, DES)</li>
                        <li>‚Ä¢ Verifica que JWT est√© firmado (.signWith)</li>
                        <li>‚Ä¢ Comprueba la l√≥gica de validaci√≥n (true/false invertidos)</li>
                        <li>‚Ä¢ AES necesita modo y padding especificados</li>
                        <li>‚Ä¢ Spring Security: permisos invertidos son un error com√∫n</li>
                    </ul>
                </div>
            </div>
            
            <!-- PRACTICAL TAB -->
            <div id="practical" class="tab-content">
                <div class="success-box">
                    <strong>Instrucciones:</strong> Lee cada caso pr√°ctico y elige la mejor soluci√≥n. Despu√©s de responder ver√°s la explicaci√≥n.
                </div>
                
                <div id="practical-cases"></div>
                
                <div style="background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); padding: 25px; border-radius: 12px; margin-top: 30px;">
                    <h3 style="color: #059669; margin-bottom: 15px;">üéØ Tips para casos pr√°cticos:</h3>
                    <ul style="line-height: 1.8;">
                        <li><strong>‚Ä¢ Archivos grandes:</strong> Siempre criptograf√≠a sim√©trica (AES)</li>
                        <li><strong>‚Ä¢ Verificar origen:</strong> Firma digital</li>
                        <li><strong>‚Ä¢ APIs sin sesiones:</strong> JWT</li>
                        <li><strong>‚Ä¢ Login social:</strong> OAuth2</li>
                        <li><strong>‚Ä¢ Contrase√±as en BD:</strong> bcrypt/Argon2, NUNCA texto plano</li>
                        <li><strong>‚Ä¢ Comunicaci√≥n segura:</strong> Cifrado h√≠brido (asim√©trica + sim√©trica)</li>
                        <li><strong>‚Ä¢ IoT/recursos limitados:</strong> ECDSA (claves cortas)</li>
                        <li><strong>‚Ä¢ Verificar integridad de archivos:</strong> Hash (SHA-256)</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <h3>üöÄ Estrategia para el examen:</h3>
            <ul>
                <li>‚úì Haz el test general primero para evaluar tu nivel</li>
                <li>‚úì Repasa las flashcards varias veces</li>
                <li>‚úì Memoriza la cheat sheet (longitudes de clave, algoritmos obsoletos)</li>
                <li>‚úì Practica identificar errores en c√≥digo</li>
                <li>‚úì Entiende CU√ÅNDO usar cada tecnolog√≠a (casos pr√°cticos)</li>
            </ul>
        </div>
    </div>
    
    <script>
        // TEST GENERAL - 30 PREGUNTAS (REORDENADAS)
        const testQuestions = [
            { id: 1, question: "¬øCu√°l es la principal caracter√≠stica de una funci√≥n hash?", options: ["Es bidireccional", "Es unidireccional e irreversible", "Requiere dos claves", "Genera salidas de longitud variable"], correct: 1 },
            { id: 2, question: "¬øQu√© algoritmo de cifrado sim√©trico es el est√°ndar actual?", options: ["DES", "3DES", "AES", "RSA"], correct: 2 },
            { id: 3, question: "En criptograf√≠a asim√©trica, ¬øcon qu√© clave se CIFRA para garantizar confidencialidad?", options: ["Clave privada", "Clave p√∫blica", "Clave sim√©trica", "No se usa clave"], correct: 1 },
            { id: 4, question: "¬øQu√© longitud de bloque utiliza AES?", options: ["64 bits", "128 bits", "192 bits", "256 bits"], correct: 1 },
            { id: 5, question: "¬øCu√°l de estos NO es un objetivo de la criptograf√≠a?", options: ["Confidencialidad", "Integridad", "Velocidad m√°xima", "No repudio"], correct: 2 },
            { id: 6, question: "¬øCon qu√© clave se FIRMA un documento digitalmente?", options: ["Clave p√∫blica", "Clave privada", "Clave sim√©trica", "Clave de sesi√≥n"], correct: 1 },
            { id: 7, question: "¬øQu√© modo de operaci√≥n de AES NO est√° recomendado?", options: ["GCM", "CBC", "ECB", "CTR"], correct: 2 },
            { id: 8, question: "DES tiene una clave de:", options: ["56 bits", "128 bits", "192 bits", "256 bits"], correct: 0 },
            { id: 9, question: "¬øQu√© garantiza una firma digital? (m√°s completa)", options: ["Solo integridad", "Solo autenticidad", "Autenticidad, integridad y no repudio", "Solo confidencialidad"], correct: 2 },
            { id: 10, question: "ECDSA 256 bits equivale en seguridad aproximadamente a RSA de:", options: ["1024 bits", "2048 bits", "3072 bits", "4096 bits"], correct: 2 },
            { id: 11, question: "¬øQu√© parte de JWT contiene los datos del usuario?", options: ["Header", "Payload", "Signature", "Token"], correct: 1 },
            { id: 12, question: "JWT es un sistema:", options: ["Stateful", "Stateless", "H√≠brido", "Con sesiones"], correct: 1 },
            { id: 13, question: "¬øQu√© algoritmo se usa t√≠picamente para firmar JWT?", options: ["RSA", "AES", "HS256 (HMAC-SHA256)", "MD5"], correct: 2 },
            { id: 14, question: "OAuth2 es un protocolo de:", options: ["Autenticaci√≥n", "Autorizaci√≥n", "Cifrado", "Hash"], correct: 1 },
            { id: 15, question: "En Spring Security, ¬øqu√© m√©todo permite acceso sin autenticaci√≥n?", options: ["authenticated()", "hasRole()", "permitAll()", "denyAll()"], correct: 2 },
            { id: 16, question: "¬øContra qu√© ataque NO protege Spring Security por defecto?", options: ["CSRF", "XSS", "DDoS", "Session Fixation"], correct: 2 },
            { id: 17, question: "¬øQu√© es el efecto avalancha en hash?", options: ["El hash crece proporcionalmente", "Peque√±o cambio = hash totalmente diferente", "Se generan m√∫ltiples hashes", "El proceso se vuelve m√°s lento"], correct: 1 },
            { id: 18, question: "bcrypt est√° especializado para:", options: ["Archivos grandes", "Almacenar contrase√±as", "Cifrar comunicaciones", "Firmar documentos"], correct: 1 },
            { id: 19, question: "¬øCu√°l es la longitud M√çNIMA recomendada para claves RSA actualmente?", options: ["512 bits", "1024 bits", "2048 bits", "4096 bits"], correct: 2 },
            { id: 20, question: "En un cifrado h√≠brido (TLS/HTTPS), ¬øqu√© se usa para intercambiar la clave?", options: ["Criptograf√≠a sim√©trica", "Criptograf√≠a asim√©trica", "Solo hash", "Texto plano"], correct: 1 },
            { id: 21, question: "¬øQu√© algoritmo hash est√° OBSOLETO?", options: ["SHA-256", "SHA-512", "MD5", "bcrypt"], correct: 2 },
            { id: 22, question: "La principal VENTAJA de la criptograf√≠a sim√©trica es:", options: ["No requiere intercambio de claves", "Es muy r√°pida", "Usa dos claves", "Permite firma digital"], correct: 1 },
            { id: 23, question: "La principal DESVENTAJA de la criptograf√≠a sim√©trica es:", options: ["Es muy lenta", "No puede cifrar archivos grandes", "Distribuci√≥n segura de la clave", "No es segura"], correct: 2 },
            { id: 24, question: "¬øCu√°l de estas longitudes NO es v√°lida para AES?", options: ["128 bits", "192 bits", "224 bits", "256 bits"], correct: 2 },
            { id: 25, question: "¬øQu√© se debe cifrar con la clave privada en una firma digital?", options: ["El mensaje completo", "El hash del mensaje", "La clave p√∫blica", "El certificado"], correct: 1 },
            { id: 26, question: "ECDSA tiene ventaja sobre RSA porque:", options: ["Es m√°s antiguo", "Claves m√°s cortas con igual seguridad", "Es m√°s lento", "Usa matem√°ticas simples"], correct: 1 },
            { id: 27, question: "¬øCu√°l es un ROL t√≠pico en OAuth2?", options: ["Hashing Server", "Authorization Server", "Encryption Server", "Validation Server"], correct: 1 },
            { id: 28, question: "Las tres partes de un JWT son:", options: ["User, password, token", "Header, payload, signature", "Public, private, shared", "Start, body, end"], correct: 1 },
            { id: 29, question: "¬øPara qu√© NO se usa una funci√≥n hash?", options: ["Verificar integridad", "Almacenar contrase√±as", "Cifrar datos reversiblemente", "Firma digital"], correct: 2 },
            { id: 30, question: "Spring Security protege por defecto contra:", options: ["Solo SQL Injection", "CSRF, XSS, Session Fixation", "Solo DDoS", "Ning√∫n ataque"], correct: 1 }
        ];

        // FLASHCARDS DATA (igual que antes)
        const flashcards = [
            { front: "¬øQu√© es un HASH?", back: "Funci√≥n matem√°tica UNIDIRECCIONAL que transforma datos de cualquier tama√±o en una cadena de LONGITUD FIJA. Es IRREVERSIBLE." },
            { front: "Diferencia: Hash vs Cifrado", back: "HASH: Unidireccional, no usa clave, longitud fija, verifica integridad\nCIFRADO: Bidireccional, usa clave(s), longitud variable, protege confidencialidad" },
            { front: "¬øQu√© es el efecto avalancha?", back: "Un peque√±o cambio en el input genera un hash COMPLETAMENTE DIFERENTE. Caracter√≠stica clave de las funciones hash seguras." },
            { front: "Algoritmos hash: ¬øCu√°les est√°n obsoletos?", back: "OBSOLETOS: MD5, SHA-1\nSEGUROS: SHA-256, SHA-512, bcrypt, scrypt, Argon2" },
            { front: "Criptograf√≠a Sim√©trica: Ventajas", back: "‚úì Muy r√°pida\n‚úì Menor carga computacional\n‚úì Ideal para archivos grandes\n‚úó Problema: distribuci√≥n segura de la clave" },
            { front: "AES: Longitudes de clave", back: "128, 192 o 256 bits\nBloques: 128 bits\nModo recomendado: GCM\nModo NO recomendado: ECB" },
            { front: "DES vs 3DES vs AES", back: "DES: 56 bits - OBSOLETO\n3DES: Triple DES - Soluci√≥n temporal\nAES: 128/192/256 bits - ACTUAL EST√ÅNDAR" },
            { front: "Criptograf√≠a Asim√©trica: Concepto", back: "PAR DE CLAVES:\n‚Ä¢ P√∫blica (se comparte)\n‚Ä¢ Privada (secreta)\nCifrar con p√∫blica ‚Üí Descifrar con privada\nCifrar con privada ‚Üí Descifrar con p√∫blica (firma)" },
            { front: "RSA: Longitud m√≠nima actual", back: "M√çNIMO RECOMENDADO: 2048 bits\nTambi√©n com√∫n: 4096 bits\nSeguridad: Factorizaci√≥n de n√∫meros primos" },
            { front: "Cifrado H√≠brido (TLS/HTTPS)", back: "1. ASIM√âTRICA (RSA/ECDH): Intercambio seguro de clave\n2. SIM√âTRICA (AES): Cifrado de datos\nCombina seguridad + velocidad" },
            { front: "Firma Digital: Proceso", back: "1. Hash del mensaje\n2. Cifrar hash con CLAVE PRIVADA = FIRMA\n3. Enviar mensaje + firma\n4. Receptor descifra con CLAVE P√öBLICA\n5. Compara hashes" },
            { front: "Firma Digital: ¬øQu√© garantiza?", back: "‚úì AUTENTICIDAD: Solo el due√±o de la clave privada pudo firmar\n‚úì INTEGRIDAD: Cualquier cambio invalida la firma\n‚úì NO REPUDIO: No puede negar haberlo enviado" },
            { front: "ECDSA vs RSA", back: "ECDSA (Curvas El√≠pticas):\n‚úì Claves m√°s cortas (256 bits ‚âà 3072 bits RSA)\n‚úì M√°s r√°pido\n‚úì Menos recursos\nUso: Bitcoin, TLS 1.3, IoT" },
            { front: "Spring Security: M√©todos de acceso", back: "‚Ä¢ permitAll() - Sin autenticaci√≥n\n‚Ä¢ authenticated() - Requiere login\n‚Ä¢ hasRole('ADMIN') - Rol espec√≠fico\n‚Ä¢ hasAuthority() - Autoridad espec√≠fica" },
            { front: "Spring Security: Protecci√≥n por defecto", back: "Protege contra:\n‚Ä¢ CSRF (Cross-Site Request Forgery)\n‚Ä¢ XSS (Cross-Site Scripting)\n‚Ä¢ Session Fixation\n‚Ä¢ Clickjacking" },
            { front: "OAuth2: ¬øQu√© es?", back: "Protocolo de AUTORIZACI√ìN DELEGADA\nNO es autenticaci√≥n directa\nPermite acceso sin compartir contrase√±as\nEjemplo: 'Iniciar sesi√≥n con Google'" },
            { front: "OAuth2: Roles principales", back: "‚Ä¢ Resource Owner: Usuario\n‚Ä¢ Client: Aplicaci√≥n\n‚Ä¢ Authorization Server: Emite tokens\n‚Ä¢ Resource Server: Protege recursos" },
            { front: "JWT: Estructura", back: "header.payload.signature\n\n‚Ä¢ HEADER: Tipo y algoritmo\n‚Ä¢ PAYLOAD: Datos del usuario (claims)\n‚Ä¢ SIGNATURE: Firma para verificar integridad" },
            { front: "JWT: Ventajas principales", back: "‚úì STATELESS: No guarda sesiones en servidor\n‚úì Autocontenido: Incluye info del usuario\n‚úì Portable: Funciona entre dominios\n‚úì Compacto: F√°cil de transmitir" },
            { front: "JWT: Algoritmo de firma com√∫n", back: "HS256 (HMAC-SHA256)\nClave sim√©trica para firmar y verificar\nOtras opciones: RS256 (RSA), ES256 (ECDSA)" },
            { front: "bcrypt: ¬øPara qu√© se usa?", back: "Especializado para ALMACENAR CONTRASE√ëAS\n‚úì Lento a prop√≥sito (protege contra fuerza bruta)\n‚úì Salt autom√°tico\n‚úì Factor de trabajo ajustable" },
            { front: "Comparativa velocidad: Sim√©trica vs Asim√©trica", back: "SIM√âTRICA: MUY R√ÅPIDA\nClaves: 128-256 bits\n\nASIM√âTRICA: LENTA\nClaves: 2048-4096 bits\n\n¬°Por eso se usa cifrado h√≠brido!" },
            { front: "¬øCu√°ndo usar Hash?", back: "‚Ä¢ Almacenar contrase√±as\n‚Ä¢ Verificar integridad de archivos\n‚Ä¢ Firma digital\n‚Ä¢ Blockchain\n‚Ä¢ Detectar duplicados" },
            { front: "Spring Security: UserDetailsService", back: "Interfaz para cargar datos de usuario\nM√©todo principal: loadUserByUsername()\nImplementaciones:\n‚Ä¢ InMemoryUserDetailsManager\n‚Ä¢ JdbcUserDetailsManager\n‚Ä¢ Custom" }
        ];
        
        // CODE QUESTIONS - 10 PREGUNTAS (REORDENADAS)
        const codeQuestions = [
            {
                id: 1,
                question: "¬øQu√© problema tiene este hash de contrase√±a?",
                code: `public String hashPassword(String password) {
    MessageDigest md = MessageDigest.getInstance("MD5");
    byte[] hash = md.digest(password.getBytes());
    return Base64.getEncoder().encodeToString(hash);
}`,
                options: [
                    "MD5 est√° obsoleto y es vulnerable, deber√≠a usar bcrypt o Argon2",
                    "Falta el try-catch",
                    "Base64 no es adecuado para contrase√±as",
                    "Deber√≠a usar SHA-1 en lugar de MD5"
                ],
                correct: 0,
                explanation: "JWT es stateless (no requiere almacenar sesiones en servidor), autocontenido y perfecto para APIs REST."
            },
            {
                id: 2,
                question: "¬øQu√© est√° mal en este cifrado AES?",
                code: `Cipher cipher = Cipher.getInstance("AES");
cipher.init(Cipher.ENCRYPT_MODE, secretKey);
byte[] encrypted = cipher.doFinal(plaintext.getBytes());`,
                options: [
                    "Falta especificar el modo y padding (ej: AES/GCM/NoPadding), ECB no es seguro",
                    "La clave debe ser de 256 bits",
                    "Falta el IV (Initialization Vector)",
                    "A y C son correctas"
                ],
                correct: 3
            },
            {
                id: 3,
                question: "¬øCu√°l es el problema en esta validaci√≥n de JWT?",
                code: `public boolean validateToken(String token) {
    try {
        Jwts.parser()
            .setSigningKey(secretKey)
            .parseClaimsJws(token);
        return true;
    } catch (Exception e) {
        return true; // ¬øEsto est√° bien?
    }
}`,
                options: [
                    "El catch devuelve true cuando deber√≠a devolver false (token inv√°lido)",
                    "Falta comprobar la fecha de expiraci√≥n",
                    "El m√©todo debe ser void",
                    "No se puede usar Exception gen√©rico"
                ],
                correct: 0
            },
            {
                id: 4,
                question: "¬øQu√© est√° MAL en esta configuraci√≥n de Spring Security?",
                code: `@Configuration
@EnableWebSecurity
public class SecurityConfig {
    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) {
        http.authorizeHttpRequests(auth -> auth
            .requestMatchers("/admin/**").permitAll()
            .requestMatchers("/public/**").hasRole("ADMIN")
            .anyRequest().authenticated()
        );
        return http.build();
    }
}`,
                options: [
                    "Las rutas est√°n invertidas: /admin debe requerir rol ADMIN y /public debe ser permitAll()",
                    "Falta el @Bean en el m√©todo",
                    "El m√©todo debe llamarse securityFilterChain",
                    "No se puede usar lambda en authorizeHttpRequests"
                ],
                correct: 0
            },
            {
                id: 5,
                question: "¬øQu√© error tiene este c√≥digo de generaci√≥n de JWT?",
                code: `public String createToken(String username) {
    Date now = new Date();
    Date validity = new Date(now.getTime() + 3600000);
    
    return Jwts.builder()
        .setSubject(username)
        .setIssuedAt(now)
        .setExpiration(validity)
        .compact(); // ¬øFalta algo?
}`,
                options: [
                    "Falta .signWith() para firmar el token",
                    "El tiempo de validez est√° mal calculado",
                    "Falta setIssuer()",
                    "No se pueden usar Dates"
                ],
                correct: 0
            },
            {
                id: 6,
                question: "¬øQu√© falta en este generador de claves RSA?",
                code: `KeyPairGenerator keyGen = KeyPairGenerator.getInstance("RSA");
keyGen.initialize(1024); // ¬øProblema aqu√≠?
KeyPair keyPair = keyGen.generateKeyPair();`,
                options: [
                    "No se puede usar RSA para generar claves",
                    "1024 bits es inseguro, m√≠nimo recomendado 2048 bits",
                    "Falta el algoritmo de firma",
                    "Deber√≠a ser KeyGenerator en lugar de KeyPairGenerator"
                ],
                correct: 1
            },
            {
                id: 7,
                question: "¬øQu√© problema tiene esta comparaci√≥n de contrase√±as?",
                code: `public boolean checkPassword(String input, String stored) {
    return input.equals(stored);
}`,
                options: [
                    "Deber√≠a usar == en lugar de equals",
                    "Las contrase√±as no deber√≠an estar en texto plano, deber√≠a comparar hashes",
                    "Falta el try-catch",
                    "El m√©todo debe ser static"
                ],
                correct: 1
            },
            {
                id: 8,
                question: "¬øQu√© est√° mal en esta verificaci√≥n de firma digital?",
                code: `Signature sig = Signature.getInstance("SHA256withRSA");
sig.initVerify(privateKey); // ¬øClave correcta?
sig.update(data);
boolean isValid = sig.verify(signatureBytes);`,
                options: [
                    "Deber√≠a usar initSign en lugar de initVerify",
                    "Deber√≠a usar la clave P√öBLICA para verificar, no la privada",
                    "SHA256withRSA no existe",
                    "Falta el algoritmo de hash"
                ],
                correct: 1
            },
            {
                id: 9,
                question: "¬øQu√© falla en este c√≥digo de almacenamiento de contrase√±as?",
                code: `public void savePassword(String username, String password) {
    String encrypted = AES.encrypt(password, secretKey);
    database.save(username, encrypted);
}`,
                options: [
                    "AES no existe como clase",
                    "Las contrase√±as NO deben cifrarse reversiblemente, deben hashearse (bcrypt/Argon2)",
                    "Falta el IV",
                    "Deber√≠a usar RSA en lugar de AES"
                ],
                correct: 1
            },
            {
                id: 10,
                question: "¬øQu√© problema tiene este filtro JWT en Spring?",
                code: `public class JwtFilter extends OncePerRequestFilter {
    protected void doFilterInternal(HttpServletRequest req, 
                                    HttpServletResponse res, 
                                    FilterChain chain) {
        String token = extractToken(req);
        if (jwtUtil.isValid(token)) {
            // ¬øFalta algo aqu√≠?
        }
        chain.doFilter(req, res);
    }
}`,
                options: [
                    "No se puede extender OncePerRequestFilter",
                    "Falta establecer la autenticaci√≥n en SecurityContextHolder",
                    "El m√©todo debe ser public",
                    "Falta el @Override"
                ],
                correct: 1
            }
        ];   
        
        // PRACTICAL CASES - 15 CASOS (REORDENADOS)
        const practicalCases = [
            {
                id: 1,
                scenario: "Desarrollas una app IoT para dispositivos con recursos limitados que necesitan firma digital. ¬øQu√© algoritmo eliges?",
                options: [
                    "RSA 4096 bits",
                    "ECDSA 256 bits",
                    "DSA 2048 bits",
                    "SHA-512 hash"
                ],
                correct: 1,
                explanation: "ECDSA ofrece la misma seguridad que RSA pero con claves m√°s cortas (256 vs 3072 bits), ideal para dispositivos limitados."
            },
            {
                id: 2,
                scenario: "Necesitas implementar un sistema donde usuarios puedan verificar que un mensaje viene realmente del CEO de la empresa. ¬øQu√© implementas?",
                options: [
                    "Cifrado sim√©trico compartido",
                    "Firma digital con la clave privada del CEO",
                    "Hash SHA-256 del mensaje",
                    "OAuth2 con Google"
                ],
                correct: 1,
                explanation: "La firma digital garantiza autenticidad (solo el CEO con su clave privada puede firmar) y no repudio."
            },
            {
                id: 3,
                scenario: "Una app necesita permitir login con Google, Facebook y GitHub sin manejar las contrase√±as. ¬øQu√© protocolo usas?",
                options: [
                    "JWT directo",
                    "OAuth2",
                    "SAML",
                    "Basic Authentication"
                ],
                correct: 1,
                explanation: "OAuth2 es el est√°ndar para autorizaci√≥n delegada, permitiendo login social sin manejar contrase√±as."
            },
            {
                id: 4,
                scenario: "Dos servidores necesitan comunicarse de forma segura en internet, enviando datos sensibles constantemente. ¬øQu√© esquema de cifrado usas?",
                options: [
                    "Solo RSA para todo",
                    "Solo AES con clave compartida de antemano",
                    "Cifrado h√≠brido: RSA/ECDH para intercambio + AES para datos",
                    "No cifrar, usar VPN"
                ],
                correct: 2,
                explanation: "Cifrado h√≠brido (como en TLS/HTTPS): asim√©trico para intercambio seguro de clave, sim√©trico para velocidad en los datos."
            },
            {
                id: 5,
                scenario: "Una empresa necesita cifrar documentos PDF de gran tama√±o (varios GB) para almacenarlos en la nube. ¬øQu√© soluci√≥n recomiendas?",
                options: [
                    "RSA (criptograf√≠a asim√©trica)",
                    "AES-256 en modo GCM (criptograf√≠a sim√©trica)",
                    "Solo aplicar SHA-256 hash",
                    "MD5 para mayor velocidad"
                ],
                correct: 1,
                explanation: "AES-256 es ideal para archivos grandes por su velocidad. RSA ser√≠a demasiado lento. Hash no cifra, solo verifica integridad."
            },
            {
                id: 6,
                scenario: "Un usuario descarga un archivo ISO de Linux. ¬øC√≥mo puede verificar que no ha sido alterado?",
                options: [
                    "Comparar el hash SHA-256 del archivo con el publicado oficialmente",
                    "Abrirlo y revisar los archivos",
                    "Confiar en el sitio web",
                    "Usar un antivirus"
                ],
                correct: 0,
                explanation: "El hash (huella digital) permite verificar integridad: si el archivo cambia aunque sea un bit, el hash ser√° completamente diferente."
            },
            {
                id: 7,
                scenario: "Est√°s desarrollando una API REST que debe funcionar sin sesiones del lado del servidor. Los usuarios necesitan autenticarse. ¬øQu√© implementas?",
                options: [
                    "Cookies de sesi√≥n tradicionales",
                    "HTTP Basic Authentication",
                    "JWT (JSON Web Tokens)",
                    "Guardar contrase√±as en localStorage"
                ],
                correct:2,
                explanation: "JWT es ideal para APIs REST sin estado (stateless), ya que no requiere sesiones en el servidor y es autocontenido."
            },
            {
                id: 8,
                scenario: "Una aplicaci√≥n web necesita protegerse contra ataques CSRF. ¬øQu√© framework ofrece esta protecci√≥n por defecto?",
                options: [         
                    "Spring Security",
                    "jQuery",
                    "Bootstrap",
                    "React"
                ],
                correct: 0,
                explanation: "Spring Security incluye protecci√≥n contra CSRF por defecto, ayudando a prevenir este tipo de ataques."
            },
            {
                id: 9,
                scenario: "Quieres almacenar contrase√±as de usuarios en tu base de datos de forma segura. ¬øQu√© m√©todo es el m√°s adecuado?",
                options: [
                    "Cifrado AES con clave secreta",
                    "Hash con bcrypt o Argon2",
                    "Hash con MD5",
                    "Almacenarlas en texto plano"
                ],
                correct: 1,
                explanation: "bcrypt y Argon2 son algoritmos de hash dise√±ados para almacenar contrase√±as de forma segura, incluyendo sal y siendo lentos para proteger contra ataques de fuerza bruta."
            },
            {
                id: 10,
                scenario: "Un desarrollador usa el modo ECB para cifrar datos con AES en su aplicaci√≥n. ¬øCu√°l es el problema con esto?",
                options: [
                    "ECB es inseguro porque no usa IV y puede revelar patrones en los datos",
                    "ECB es demasiado lento",
                    "ECB requiere claves de 512 bits",
                    "No hay problema, es el modo recomendado"
                ],
                correct: 0,
                explanation: "El modo ECB no es seguro porque no utiliza un vector de inicializaci√≥n (IV) y puede revelar patrones en los datos cifrados, comprometiendo la confidencialidad."
            },
            {
                id: 11,
                scenario: "Necesitas generar un par de claves para cifrado asim√©trico. ¬øQu√© longitud de clave es la m√≠nima recomendada para RSA en 2024?",
                options: [
                    "1024 bits",
                    "2048 bits",
                    "4096 bits",
                    "512 bits"
                ],
                correct: 1,
                explanation: "La longitud m√≠nima recomendada para claves RSA en 2024 es de 2048 bits para garantizar seguridad adecuada."
            },
            {
                id: 12,
                scenario: "Un sistema utiliza JWT para autenticaci√≥n. ¬øQu√© parte del JWT contiene la informaci√≥n del usuario?",
                options: [
                    "Header",
                    "Payload",
                    "Signature",
                    "Token ID"
                ],
                correct: 1,
                explanation: "El Payload del JWT contiene los datos del usuario (claims), mientras que el Header especifica el tipo y algoritmo, y la Signature verifica la integridad."
            },
            {
                id: 13,
                scenario: "Est√°s configurando Spring Security y quieres permitir acceso libre a la ruta /public/** y restringir /admin/** solo a usuarios con rol ADMIN. ¬øCu√°l es la configuraci√≥n correcta?",
                options: [
                    "requestMatchers('/admin/**').permitAll(); requestMatchers('/public/**').hasRole('ADMIN');",
                    "requestMatchers('/public/**').permitAll(); requestMatchers('/admin/**').hasRole('ADMIN');",
                    "requestMatchers('/admin/**').authenticated(); requestMatchers('/public/**').authenticated();",
                    "requestMatchers('/public/**').denyAll(); requestMatchers('/admin/**').permitAll();"
                ],
                correct: 1,
                explanation: "La configuraci√≥n correcta es permitir todo en /public/** y restringir /admin/** a usuarios con rol ADMIN."
            },
            {
                id: 14,
                scenario: "Quieres proteger una API REST sin estado. ¬øCu√°l es la mejor opci√≥n para manejar la autenticaci√≥n de usuarios?",
                options: [
                    "Usar sesiones en el servidor",
                    "Usar JWT (JSON Web Tokens)",
                    "Usar cookies de sesi√≥n",
                    "Almacenar contrase√±as en localStorage"
                ],
                correct: 1,
                explanation: "JWT es ideal para APIs REST sin estado (stateless), ya que no requiere sesiones en el servidor y es autocontenido."
            },
            {
                id: 15,
                scenario: "Un desarrollador est√° usando MD5 para hashear contrase√±as. ¬øCu√°l es el problema principal con este enfoque?",
                options: [
                    "MD5 es demasiado lento",
                    "MD5 est√° obsoleto y es vulnerable a colisiones",
                    "MD5 requiere claves largas",
                    "MD5 no produce hashes de longitud fija"
                ],
                correct: 1,
                explanation: "MD5 est√° obsoleto y es vulnerable a ataques de colisi√≥n, por lo que no es adecuado para hashear contrase√±as. Se recomiendan algoritmos m√°s seguros como bcrypt o Argon2."
            }
        ];
        
        let currentCardIndex = 0;
        let testAnswers = {};
        
        // FLASHCARD FUNCTIONS
        function showCard(index) {
            document.getElementById('card-front').textContent = flashcards[index].front;
            document.getElementById('card-back').textContent = flashcards[index].back;
            document.getElementById('current-card').textContent = index + 1;
            document.getElementById('total-cards').textContent = flashcards.length;
            document.getElementById('flashcard').classList.remove('flipped');
        }
        
        function flipCard() {
            document.getElementById('flashcard').classList.toggle('flipped');
        }
        
        function nextCard() {
            currentCardIndex = (currentCardIndex + 1) % flashcards.length;
            showCard(currentCardIndex);
        }
        
        function prevCard() {
            currentCardIndex = (currentCardIndex - 1 + flashcards.length) % flashcards.length;
            showCard(currentCardIndex);
        }
        
        // TEST GENERAL FUNCTIONS
        function renderTestQuestions() {
            const container = document.getElementById('test-questions');
            testQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                questionDiv.innerHTML = `
                    <h3>Pregunta ${index + 1}</h3>
                    <p style="margin-bottom: 15px; font-weight: 500;">${q.question}</p>
                    <div class="options" id="test-options-${q.id}">
                        ${q.options.map((opt, i) => `
                            <div class="option" onclick="selectTestOption(${q.id}, ${i})">
                                ${opt}
                            </div>
                        `).join('')}
                    </div>
                `;
                container.appendChild(questionDiv);
            });
        }
        
        function selectTestOption(questionId, optionIndex) {
            testAnswers[questionId] = optionIndex;
            const optionsDiv = document.getElementById(`test-options-${questionId}`);
            const options = optionsDiv.querySelectorAll('.option');
            options.forEach((opt, i) => {
                opt.classList.remove('selected');
                if (i === optionIndex) {
                    opt.classList.add('selected');
                }
            });
        }
        
        function submitTest() {
            if (Object.keys(testAnswers).length < testQuestions.length) {
                alert(`Has respondido ${Object.keys(testAnswers).length} de ${testQuestions.length} preguntas. Por favor, responde todas antes de enviar.`);
                return;
            }
            
            let correct = 0;
            testQuestions.forEach(q => {
                const optionsDiv = document.getElementById(`test-options-${q.id}`);
                const options = optionsDiv.querySelectorAll('.option');
                const userAnswer = testAnswers[q.id];
                
                options.forEach((opt, i) => {
                    opt.onclick = null;
                    if (i === q.correct) {
                        opt.classList.add('correct');
                    } else if (i === userAnswer && i !== q.correct) {
                        opt.classList.add('incorrect');
                    }
                });
                
                if (userAnswer === q.correct) {
                    correct++;
                }
            });
            
            const percentage = ((correct / testQuestions.length) * 100).toFixed(1);
            const resultDiv = document.getElementById('test-result');
            const passed = percentage >= 50;
            
            resultDiv.className = passed ? 'test-result' : 'test-result fail';
            resultDiv.innerHTML = `
                <h2>${passed ? '¬°Aprobado! üéâ' : 'Necesitas repasar üìö'}</h2>
                <p style="font-size: 1.5em; margin: 10px 0;">${correct} / ${testQuestions.length} correctas</p>
                <p style="font-size: 1.2em;">${percentage}%</p>
                <p style="margin-top: 15px;">
                    ${percentage >= 90 ? 'Excelente dominio del temario' :
                      percentage >= 70 ? 'Buen conocimiento, repasa algunos puntos' :
                      percentage >= 50 ? 'Aprobado, pero estudia m√°s los temas fallados' :
                      'Repasa el temario completo y vuelve a intentarlo'}
                </p>
            `;
            resultDiv.style.display = 'block';
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // CODE QUESTIONS FUNCTIONS
        function renderCodeQuestions() {
            const container = document.getElementById('code-questions');
            codeQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                questionDiv.innerHTML = `
                    <h3>Pregunta ${index + 1}: ${q.question}</h3>
                    <div class="code-block"><pre><code>${q.code.replace(/</g, '&lt;').replace(/>/g, '&gt;')}</code></pre></div>
                    <div class="options" id="code-options-${q.id}">
                        ${q.options.map((opt, i) => `
                            <div class="option" onclick="selectCodeOption(${q.id}, ${i}, ${q.correct})">
                                ${opt}
                            </div>
                        `).join('')}
                    </div>
                    <div id="code-explanation-${q.id}" style="display: none;"></div>
                `;
                container.appendChild(questionDiv);
            });
        }
        
        function selectCodeOption(questionId, selected, correct) {
            const optionsDiv = document.getElementById(`code-options-${questionId}`);
            const options = optionsDiv.querySelectorAll('.option');
            const explanationDiv = document.getElementById(`code-explanation-${questionId}`);
            
            options.forEach((opt, i) => {
                opt.onclick = null;
                if (i === correct) {
                    opt.classList.add('correct');
                } else if (i === selected && i !== correct) {
                    opt.classList.add('incorrect');
                }
            });
            
            const question = codeQuestions.find(q => q.id === questionId);
            if (selected === correct) {
                explanationDiv.className = 'success-box';
                explanationDiv.innerHTML = '<strong>‚úÖ ¬°Correcto!</strong>';
            } else {
                explanationDiv.className = 'explanation';
                explanationDiv.innerHTML = `<strong>‚ùå Incorrecto</strong><br><br><strong>Respuesta correcta:</strong> ${question.options[correct]}`;
            }
            explanationDiv.style.display = 'block';
        }
        
        // PRACTICAL CASES FUNCTIONS
        function renderPracticalCases() {
            const container = document.getElementById('practical-cases');
            practicalCases.forEach((c, index) => {
                const caseDiv = document.createElement('div');
                caseDiv.className = 'question';
                caseDiv.innerHTML = `
                    <h3>Caso ${index + 1}</h3>
                    <p style="margin-bottom: 15px;">${c.scenario}</p>
                    <div class="options" id="practical-options-${c.id}">
                        ${c.options.map((opt, i) => `
                            <div class="option" onclick="selectPracticalOption(${c.id}, ${i}, ${c.correct}, \`${c.explanation.replace(/`/g, '\\`')}\`)">
                                ${opt}
                            </div>
                        `).join('')}
                    </div>
                    <div id="practical-explanation-${c.id}" style="display: none;"></div>
                `;
                container.appendChild(caseDiv);
            });
        }
        
        function selectPracticalOption(caseId, selected, correct, explanation) {
            const optionsDiv = document.getElementById(`practical-options-${caseId}`);
            const options = optionsDiv.querySelectorAll('.option');
            const explanationDiv = document.getElementById(`practical-explanation-${caseId}`);
            
            options.forEach((opt, i) => {
                opt.onclick = null;
                if (i === correct) {
                    opt.classList.add('correct');
                } else if (i === selected && i !== correct) {
                    opt.classList.add('incorrect');
                }
            });
            
            if (selected === correct) {
                explanationDiv.className = 'success-box';
                explanationDiv.innerHTML = `<strong>‚úÖ ¬°Correcto!</strong><br><br><strong>Explicaci√≥n:</strong> ${explanation}`;
            } else {
                explanationDiv.className = 'warning-box';
                explanationDiv.innerHTML = `<strong>üí° Revisa la explicaci√≥n:</strong><br><br>${explanation}`;
            }
            explanationDiv.style.display = 'block';
        }
        
        function showTab(tabName) {
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }
        
        // INITIALIZE
        showCard(0);
        renderTestQuestions();
        renderCodeQuestions();
        renderPracticalCases();
    </script>
</body>
</html>
